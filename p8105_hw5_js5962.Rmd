---
title: "p8105_hw5_js5962"
output: github_document
---

```{r setup,echo = FALSE, message = FALSE}
library(tidyverse)

theme_set(theme_minimal() + theme(legend.position = "bottom"))
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = 0.6,
  out.width = "90%"
)

options(
  ggplot2.continuous.color = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_color_discrete = scale_color_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```


## Problem 1


a) Import the data and clean.

```{r import_data}
homicide_df =
  read.csv("homicide-data.csv", na = c("", "Unknown")) 
```

Describe the raw data: The dataset homicide_data is collected by _The Washington Post_ on homicides in 50 large U.S. cities. The data contains `r nrow(homicide_df)` rows and `r ncol(homicide_df)` columns. Each row represents one case. Variables describe the report data, location, victim's information and disposition od the cases.

```{r dataclean}
homicide_clean =
  homicide_df %>% 
  mutate(city_state = str_c(city, ",", state),#create variable
         result = case_when(
           disposition == "Closed without arrest" ~ "unsolved",
           disposition == "Open/No arrest" ~ "unsolved",
           disposition == "Closed by arrest" ~ "solved"
         )) %>% 
  relocate(city_state) %>% 
  filter(city_state != "Tulsa,AL") 
homicide_clean %>% 
  select(-city, -state) %>% #summarize numbers
  group_by(city_state) %>% 
  summarize(unsolved = sum(result == "unsolved"),#summarize numbers
            n = n()) %>% 
  knitr::kable()
```

b) use the prop.test function to estimate the proportion of homicides that are unsolved in the city of Baltimore, MD.

```{r blatimore}
baltimore_df = homicide_clean %>% 
  filter(city_state == "Baltimore,MD")

baltimore_unsolved =     
  baltimore_df %>% 
  summarize(unsolved = sum(result == "unsolved"),
            n = n())
baltimore_prop =
  prop.test(x = baltimore_unsolved %>% pull(unsolved), 
          n = baltimore_unsolved %>% pull(n))
tidy_df = baltimore_prop %>% 
  broom::tidy()
tidy_df
# pull the estimated proportion and confidence intervals from the resulting tidy dataframe
tidy_df$estimate
tidy_df$conf.low
tidy_df$conf.high
```



